# TODO

## tui-scrollview を使ったログビューアの改善

### フェーズ1: 依存関係の追加とテスト環境の準備
- [ ] Cargo.tomlに`tui-scrollview`クレートを追加
- [ ] 既存のログビューアのテストケースを整理・文書化
- [ ] tui-scrollviewを使った新しいログビューアのユニットテストを作成（TDDアプローチ）
- [ ] 統合テストの準備（大規模ログファイルのテストケース）

### フェーズ2: 新しい実装の作成
- [ ] `LogViewerScrollWidget`構造体の実装
- [ ] `ScrollViewState`を使った状態管理の実装
- [ ] 行番号表示機能の実装（左側の固定カラム）
- [ ] ログ内容表示機能の実装（スクロール可能なメインエリア）
- [ ] ヘッダー/フッターのレンダリング機能の維持
- [ ] 現在行のハイライト機能の実装

### フェーズ3: 機能の移行
- [ ] メモリ制限機能（MAX_LINES_IN_MEMORY: 10,000行）の実装
- [ ] インクリメンタル読み込み機能の移行
  - [ ] ファイルサイズ変更の検知
  - [ ] 新規行のみの追加読み込み
- [ ] キーボードナビゲーションの実装
  - [ ] j/k キーでの上下スクロール
  - [ ] gg でトップへ移動
  - [ ] G でボトムへ移動
  - [ ] Page Up/Down のサポート
- [ ] 既存のキャッシュ機能との統合
- [ ] エラーハンドリングの改善

### フェーズ4: パフォーマンス最適化とテスト
- [ ] ベンチマークテストの作成
  - [ ] 大規模ファイル（1GB以上）でのスクロール性能測定
  - [ ] メモリ使用量の比較測定
  - [ ] CPU使用率の測定
- [ ] レンダリング最適化
  - [ ] 可視範囲外のウィジェットのスキップ
  - [ ] 差分レンダリングの活用
- [ ] 既存実装との性能比較レポート作成

### フェーズ5: 統合と移行
- [ ] app.rsでの新しいログビューアへの切り替え
- [ ] 既存のLogViewerWidgetから新実装への段階的移行
- [ ] ユーザーテストとフィードバックの収集
- [ ] ドキュメントの更新

### 追加の改善案
- [ ] スクロールバーの表示（tui-scrollviewが対応次第）
- [ ] 横スクロールのサポート（長い行への対応）
- [ ] ログレベルによる色分け表示
- [ ] 検索機能の追加（/キーで検索モード）
- [ ] フィルタリング機能（特定のパターンのみ表示）

## その他のタスク

### リファクタリング
- [ ] 使用されていないコードの削除
- [ ] エラーハンドリングの統一化

### ドキュメント
- [ ] README.mdの更新
- [ ] アーキテクチャドキュメントの作成