# TODO

## tui-scrollview を使ったログビューアの改善

### フェーズ1: 依存関係の追加とテスト環境の準備
- [x] Cargo.tomlに`tui-scrollview`クレートを追加
- [x] 既存のログビューアのテストケースを整理・文書化
- [x] tui-scrollviewを使った新しいログビューアのユニットテストを作成（TDDアプローチ）
- [x] 統合テストの準備（大規模ログファイルのテストケース）

### フェーズ2: 新しい実装の作成
- [x] `LogViewerScrollWidget`構造体の実装
- [x] `ScrollViewState`を使った状態管理の実装
- [x] 行番号表示機能の実装（左側の固定カラム）
- [x] ログ内容表示機能の実装（スクロール可能なメインエリア）
- [x] ヘッダー/フッターのレンダリング機能の維持
- [ ] ~~現在行のハイライト機能の実装~~ (ユーザーの要望により実装しない)

### フェーズ3: 機能の移行
- [x] メモリ制限機能（MAX_LINES_IN_MEMORY: 10,000行）の実装
- [x] インクリメンタル読み込み機能の移行
  - [x] ファイルサイズ変更の検知
  - [x] 新規行のみの追加読み込み
- [x] キーボードナビゲーションの実装
  - [x] j/k キーでの上下スクロール
  - [x] gg でトップへ移動
  - [x] G でボトムへ移動
  - [x] Page Up/Down のサポート
  - [x] h/l キーでの左右スクロール
- [x] 既存のキャッシュ機能との統合
- [x] エラーハンドリングの改善

### フェーズ4: パフォーマンス最適化とテスト
- [ ] ベンチマークテストの作成
  - [ ] 大規模ファイル（1GB以上）でのスクロール性能測定
  - [ ] メモリ使用量の比較測定
  - [ ] CPU使用率の測定
- [ ] レンダリング最適化
  - [ ] 可視範囲外のウィジェットのスキップ
  - [ ] 差分レンダリングの活用
- [ ] 既存実装との性能比較レポート作成

### フェーズ5: 統合と移行
- [x] app.rsでの新しいログビューアへの切り替え
- [x] 既存のLogViewerWidgetから新実装への完全移行（古い実装は削除）
- [x] ユーザーテストとフィードバックの収集
- [ ] ドキュメントの更新

### 追加の改善案
- [x] ~~スクロールバーの表示~~ (ユーザーの要望により非表示に設定)
- [x] 横スクロールのサポート（h/lキーで実装済み）
- [ ] ログレベルによる色分け表示
- [ ] 検索機能の追加（/キーで検索モード）
- [ ] フィルタリング機能（特定のパターンのみ表示）

### UI改善
- [x] ログビューアとフッターの境界線を├─┤で接続
- [x] タスクIDを省略せず表示（listコマンドとタスクリスト）

## その他のタスク

### リファクタリング
- [x] 使用されていないコードの削除（旧ログビューア実装を削除）
- [ ] エラーハンドリングの統一化

### ドキュメント
- [ ] README.mdの更新
- [ ] アーキテクチャドキュメントの作成